--- 
- hosts: webserver
  vars: 
    http_port: 80 
    max_clients: 200 
  remote_user: root 
  tasks:     
  - name: ensure apache is at the latest version 
    yum: 
      name: httpd 
      state: latest
    become: true
  - name: write the apache config file 
    template: 
      src: files/index.html
      dest: /etc/index.html 
    notify: 
    - restart apache 
  - name: ensure apache is running 
    service: 
      name: httpd 
      state: started 
  - name: Open port 80 for http access
    firewalld:
      service: http
      permanent: true
      state: enabled
  - name: Restart the firewalld service to load in the firewall changes
    service: 
      name: firewalld 
      state: restarted
  handlers: 
    - name: restart apache 
      service: 
        name: httpd 
        state: restarted
